import { getState } from './state.js';import { ROLES, PERMS, permsForRole } from './roles.js';export function getRole(){ return getState().userProfile?.role ?? null; }export function isSuperAdmin(){ return getRole()===ROLES.SUPERADMIN; }export function getEffectivePermissions(){ const s=getState(); if(!s.user || !s.userProfile?.role) return {}; if(isSuperAdmin()) return Object.fromEntries(Object.values(PERMS).map(k=>[k,true])); const role=s.userProfile.role; const matrix=s.roleMatrix?.[role]; const base=matrix?matrix:permsForRole(role); const overrides=s.userOverrides||{}; return { ...base, ...overrides }; }export function can(key){ return Boolean(getEffectivePermissions()?.[key]); }export { PERMS };